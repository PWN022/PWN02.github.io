---
layout: post
title: 华南师范大学CSRF漏洞提交
author: PWN022
tags:
- Network security
date: 2025-10-13 17:26 +0800
toc:  true
excerpt: ""

---

# 华南师范大学邮箱登录接口存在 CSRF 漏洞（可伪造登录请求）

## 漏洞概述

华南师范大学统一邮箱登录页面 `https://mail.scnu.edu.cn/` 在点击登录后表单会被 JS 重定向至 `https://mail.scnu.edu.cn/index.jsp`进行认证，上述地址均未部署任何 CSRF 防护机制（无 token、无验证码、无 SameSite 约束），攻击者可构造恶意网页，在受害者浏览器中跨站伪造登录请求，从而进入受害者邮箱。

## 漏洞原理

1. 登录表单依赖纯 POST 请求，字段固定：
   `uid/uin`、`password`、`domain` 等。
2. 服务器端 **未验证 Referer** ，也未对 Cookie 设置 `SameSite` 属性。
3. 综上，攻击者可在第三方站点构造恶意表单，利用受害者浏览器中的有效 Cookie 完成跨站伪造登录。

## 验证步骤

1. 访问登录页 → F12 抓包，POST 内容示例：
   `uid=12345&password=12345&domain=scnu.edu.cn`
   **无 csrf/token 字段** 。

   ![](E:\Files\提交漏洞\华北师范大学20251013\网站存在csrf.png)

2. 响应头 Set-Cookie：
   `TS013c4e29030=xxx; Path=/; Domain=.scnu.edu.cn`
   **缺失 SameSite 属性** ，跨站请求时会自动携带。

   ![](https://cdn.jsdelivr.net/gh/PWN022/0x00@main/NetSecurity/My_screenshot/%E7%BD%91%E7%AB%99%E5%AD%98%E5%9C%A8csrf1.png)

3. 本地构造静态 HTML（action 指向 `index.jsp`），浏览器 可正常生成请求且未被 403 拦截，证明后端未做 referer/token 校验。

## 风险影响

需受害者已存在有效 Cookie 且主动访问攻击链接，利用条件苛刻，故定级低危。利用成功可进入受害者邮箱，进一步窃取邮件、重置校内系统密码、发起钓鱼。

## 发现日期

2025-10-13